(function(t){function e(e){for(var a,r,s=e[0],l=e[1],d=e[2],u=0,p=[];u<s.length;u++)r=s[u],Object.prototype.hasOwnProperty.call(i,r)&&i[r]&&p.push(i[r][0]),i[r]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(t[a]=l[a]);c&&c(e);while(p.length)p.shift()();return o.push.apply(o,d||[]),n()}function n(){for(var t,e=0;e<o.length;e++){for(var n=o[e],a=!0,s=1;s<n.length;s++){var l=n[s];0!==i[l]&&(a=!1)}a&&(o.splice(e--,1),t=r(r.s=n[0]))}return t}var a={},i={app:0},o=[];function r(e){if(a[e])return a[e].exports;var n=a[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=t,r.c=a,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)r.d(n,a,function(e){return t[e]}.bind(null,a));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],l=s.push.bind(s);s.push=e,s=s.slice();for(var d=0;d<s.length;d++)e(s[d]);var c=l;o.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"034f":function(t,e,n){"use strict";n("85ec")},1:function(t,e){},2:function(t,e){},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d"),n("e792"),n("0cdd");var a=n("2b0e"),i=(n("2dd8"),n("f9e3"),n("5f5b")),o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app",align:"center"}},[n("div",{staticClass:"cell cell-map"},[n("MapContainer")],1)])},r=[],s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"map-root",staticStyle:{width:"100%",height:"100%"},attrs:{id:"map-root"}},[null!=this.dataMap?n("div",{staticStyle:{width:"100%"},attrs:{align:"right"}},[n("b-button",{attrs:{variant:"outline-secondary",size:"sm"},on:{click:t.downloadJson}},[t._v("Download Json")]),n("b-button",{directives:[{name:"b-toggle",rawName:"v-b-toggle.sidebar-prices",modifiers:{"sidebar-prices":!0}}],attrs:{variant:"outline-secondary",size:"sm"}},[t._v("Prices")]),n("b-sidebar",{attrs:{id:"sidebar-prices",title:"Prices",right:"",shadow:"","bg-variant":"light","text-variant":"secondary"}},[n("div",{staticClass:"px-3 py-2",staticStyle:{width:"90%"},attrs:{align:"left"}},t._l(this.r_prices,(function(e){return n("div",{key:e.product_id},[n("span",{domProps:{innerHTML:t._s(e.product_id)}}),t._v(":"),n("br"),n("b-input-group",[n("b-form-input",{attrs:{placeholder:"Enter price",trim:""},model:{value:e.price,callback:function(n){t.$set(e,"price",n)},expression:"prc.price"}}),t._v(" "+t._s(e.currency)+" ")],1),n("b-button",{attrs:{variant:"outline-secondary",size:"sm"},on:{click:function(n){return t.updatePrice(e,e.price)}}},[t._v("Update")]),n("br"),n("br")],1)})),0)])],1):t._e(),n("FileUpload",{on:{CustomEventInputChanged:t.getDateFromJson}}),n("b-modal",{attrs:{id:"bv-modal-station"},scopedSlots:t._u([{key:"modal-header",fn:function(){return[t.isChangeNAbil?t._e():n("span",{domProps:{innerHTML:t._s(t.r_starion.name)}}),t.isChangeNAbil?n("b-form-input",{attrs:{placeholder:"Enter station name",trim:""},model:{value:t.r_starion.name,callback:function(e){t.$set(t.r_starion,"name",e)},expression:"r_starion.name"}}):t._e(),t.isChangeNAbil?t._e():n("b-button",{attrs:{variant:"outline-secondary",size:"sm"},on:{click:t.openNameForChange}},[t._v("Change")])]},proxy:!0},{key:"modal-footer",fn:function(){return[n("b-button",{attrs:{variant:"outline-secondary",disabled:!t.isChangeNAbil},on:{click:t.saveNameStation}},[t._v("Save update")]),n("b-button",{attrs:{variant:"outline-secondary"},on:{click:t.deleteStation}},[t._v("Delete station")]),n("b-button",{attrs:{variant:"outline-secondary"},on:{click:t.closeModal}},[t._v("Close")])]},proxy:!0}])},[n("div",[n("span",[t._v("Adress: ")]),n("span",{domProps:{innerHTML:t._s(t.r_starion.address)}}),n("br"),n("span",[t._v("City: ")]),n("span",{domProps:{innerHTML:t._s(t.r_starion.city)}}),t._v(" "),n("br"),n("span",[t._v("Latitude: ")]),n("span",{domProps:{innerHTML:t._s(t.r_starion.latitude)}}),n("span",[t._v(" Longitude: ")]),n("span",{domProps:{innerHTML:t._s(t.r_starion.longitude)}}),n("hr"),t._l(t.r_product,(function(e){return n("div",{key:e.product_id},["available"==e.status?n("div",[n("span",{domProps:{innerHTML:t._s(e.product_id)}}),t._v(": "),n("span",{domProps:{innerHTML:t._s(e.price)}}),t._v(" "),n("span",{domProps:{innerHTML:t._s(e.currency)}}),n("br")]):t._e()])}))],2)]),n("b-modal",{attrs:{id:"bv-modal-new-station","hide-footer":""},scopedSlots:t._u([{key:"modal-title",fn:function(){return[t._v(" Input New Fuel Station ")]},proxy:!0}])},[n("div",{staticClass:"d-block text-center"},[n("b-form-input",{attrs:{state:t.idState,type:"number","aria-describedby":"input-live-help input-live-feedback",placeholder:"Enter id station",trim:""},model:{value:t.n_id,callback:function(e){t.n_id=e},expression:"n_id"}}),n("br"),n("b-form-input",{attrs:{state:t.nameState,"aria-describedby":"input-live-help input-live-feedback",placeholder:"Enter station name",trim:""},model:{value:t.n_name,callback:function(e){t.n_name=e},expression:"n_name"}}),n("br"),n("b-form-input",{attrs:{state:t.adrState,"aria-describedby":"input-live-help input-live-feedback",placeholder:"Enter station address",trim:""},model:{value:t.n_address,callback:function(e){t.n_address=e},expression:"n_address"}}),n("br"),n("b-form-input",{attrs:{state:t.cityState,"aria-describedby":"input-live-help input-live-feedback",placeholder:"Enter station city",trim:""},model:{value:t.n_city,callback:function(e){t.n_city=e},expression:"n_city"}}),n("br"),n("b-form-input",{attrs:{state:t.latitState,"aria-describedby":"input-live-help input-live-feedback",disabled:"",placeholder:"Enter station latitude",trim:""},model:{value:t.n_latitude,callback:function(e){t.n_latitude=e},expression:"n_latitude"}}),n("br"),n("b-form-input",{attrs:{state:t.longState,"aria-describedby":"input-live-help input-live-feedback",disabled:"",placeholder:"Enter station longitude",trim:""},model:{value:t.n_longitude,callback:function(e){t.n_longitude=e},expression:"n_longitude"}})],1),n("div",[n("b-button",{staticClass:"mt-2",attrs:{disabled:t.saveDis},on:{click:t.saveStation}},[t._v("Save")]),n("b-button",{staticClass:"mt-2",on:{click:function(e){return t.$bvModal.hide("bv-modal-new-station")}}},[t._v("Close")])],1)])],1)},l=[],d=(n("d3b7"),n("3ca3"),n("ddb0"),n("2b3d"),n("159b"),n("b0c0"),n("4cdf")),c=n("5eee"),u=n("a2c7"),p=n("5831"),f=n("d0e9"),h=n("f2f0"),b=n("6c77"),_=n("ce2c"),v=n("83a6"),m=n("f403"),g=n("3e6b"),y=n("480c"),w=n("256f"),M=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticStyle:{width:"50%"}},[t.isDataMapLoad?t._e():n("div",[n("b-form-file",{ref:"file-input",attrs:{state:Boolean(t.selectedFile),placeholder:"Choose or drop here...","drop-placeholder":"Drop here...",accept:".json",size:"sm"},model:{value:t.selectedFile,callback:function(e){t.selectedFile=e},expression:"selectedFile"}}),n("div",{staticClass:"mt-3"},[t._v("Selected file: "),n("b",[t._v(t._s(t.selectedFile?t.selectedFile.name:""))])]),n("b-button",{staticClass:"mr-2",attrs:{disabled:!this.selectedFile,size:"sm",variant:"outline-secondary"},on:{click:t.onUploadFile}},[t._v("Load JSON")]),n("b-button",{attrs:{disabled:!this.selectedFile,size:"sm",variant:"outline-secondary"},on:{click:t.clearFiles}},[t._v("Reset input")])],1)])},S=[],k=n("bc3a"),C=n.n(k),F={data:function(){return{selectedFile:null,isDataMapLoad:!1,dataMap:null}},methods:{onUploadFile:function(){var t=this,e=new FormData;e.append("file",this.selectedFile),C.a.post("http://localhost:4500/upload",e,{headers:{"Content-Type":"multipart/form-data"}}).then((function(e){t.dataMap=e.data,t.isDataMapLoad=!1,t.$emit("CustomEventInputChanged",t.dataMap)})).catch((function(t){console.log(t)}))},clearFiles:function(){this.$refs["file-input"].reset()},emitEventChanged:function(){alert(this.dataMap),this.$emit("CustomEventInputChanged",this.dataMap)}}},x=F,O=n("2877"),j=Object(O["a"])(x,M,S,!1,null,null,null),N=j.exports,P=(n("5bc0"),[8.52981,47.3943939]),L=null,E={name:"MapContainer",components:{FileUpload:N},data:function(){return{dataMap:null,station:[],prices:[],products:[],place:[],feat:[],s_id:[],s_layers:[],r_starion:{},r_product:[],r_prices:[],n_id:null,n_name:null,n_address:null,n_city:null,n_latitude:null,n_longitude:null,n_prices:[],isChangeNAbil:!1}},props:{},methods:{closeModal:function(){this.isChangeNAbil=!1,this.$bvModal.hide("bv-modal-station")},openNameForChange:function(){this.isChangeNAbil=!0},downloadJson:function(){var t=this,e=new FormData;e.append("json",JSON.stringify(t.dataMap)),C.a.post("http://localhost:4500/download",e).then((function(t){console.log(t);var e=window.URL.createObjectURL(new Blob([t.data])),n=document.createElement("a");n.href=e,n.setAttribute("download","jsonMap.json"),document.body.appendChild(n),n.click()})).catch((function(t){console.log(t)}))},updatePrice:function(t,e){for(var n=this,a=0;a<n.r_prices.length;a++)if(n.r_prices[a].product_id==t.product_id){n.r_prices[a].price=e;break}for(a=0;a<n.dataMap.length;a++)n.dataMap[a].prices.product_id==t.product_id&&(n.dataMap[a].prices.price=e);var i=new FormData;i.append("json",JSON.stringify(n.dataMap)),C.a.post("http://localhost:4500/save",i).then((function(t){console.log(t)})).catch((function(t){console.log(t)}))},deleteStation:function(){for(var t=this,e=this,n=new FormData,a=[],i=0;i<e.dataMap.length;i++)e.dataMap[i].id!=e.r_starion.id&&a.push(e.dataMap[i]);e.dataMap=a,n.append("json",JSON.stringify(e.dataMap)),C.a.post("http://localhost:4500/save",n).then((function(n){console.log(n),L.getLayers().forEach((function(t){t&&t.get("id")===e.r_starion.id&&L.removeLayer(t)})),t.$bvModal.hide("bv-modal-station")})).catch((function(t){console.log(t)}))},saveNameStation:function(){for(var t=this,e=this,n=new FormData,a=0;a<e.dataMap.length;a++)e.dataMap[a].id==e.r_starion.id&&(e.dataMap[a].name=e.r_starion.name);n.append("json",JSON.stringify(e.dataMap)),C.a.post("http://localhost:4500/save",n).then((function(e){console.log(e),t.isChangeNAbil=!1})).catch((function(t){console.log(t)}))},saveStation:function(){var t=this,e=new FormData;console.log("map: "+t.dataMap),t.dataMap.push({id:t.n_id,name:t.n_name,city:t.n_city,address:t.n_address,latitude:t.n_latitude,longitude:t.n_longitude}),e.append("json",JSON.stringify(t.dataMap)),C.a.post("http://localhost:4500/save",e).then((function(e){console.log(e);var n=new m["a"](Object(w["d"])([t.n_longitude,t.n_latitude])),a=new d["a"](n),i=new g["a"]({id:t.n_id,source:new p["a"]({features:[a]}),style:new b["b"]({image:new _["a"]({radius:5,fill:new v["a"]({color:"red"})})})});L.addLayer(i),t.station=t.dataMap,t.n_id=null,t.n_name=null,t.n_city=null,t.n_address=null,t.n_latitude=null,t.n_longitude=null,t.$bvModal.hide("bv-modal-new-station")})).catch((function(t){console.log(t)}))},getDateFromJson:function(t){var e=this;e.dataMap=t;for(var n=0;n<e.dataMap.length;n++){if(e.station[n]=e.dataMap[n],console.log("Station: "+this.station[n]),e.prices.push(e.station[n].prices),void 0!=e.station[n].prices){var a=e.station[n].prices;e.r_prices.push(a[0]),e.products.push(e.station[n].products)}e.place[n]=new m["a"](Object(w["d"])([e.station[n].longitude,e.station[n].latitude])),e.feat.push(new d["a"](e.place[n])),e.s_id.push(e.station[n].id);var i=new g["a"]({id:this.s_id[n],source:new p["a"]({features:[e.feat[n]]}),style:new b["b"]({image:new _["a"]({radius:5,fill:new v["a"]({color:"red"})})})});this.s_layers.push(i)}var o=Object(w["d"])(P);for(console.log("prices: "+JSON.stringify(this.prices)),L=new c["a"]({target:"map-root",layers:[new y["a"]({source:new f["a"]}),new y["a"]({source:new h["a"]({projection:"EPSG:21781"})})],view:new u["a"]({zoom:12,center:o})}),n=0;n<e.dataMap.length;n++)L.addLayer(e.s_layers[n]);L.on("singleclick",(function(t){if(1!=L.hasFeatureAtPixel(t.pixel)){var n=t.coordinate,a=Object(w["l"])(n);e.n_latitude=a[1],e.n_longitude=a[0],console.log("self: "+e),e.$bvModal.show("bv-modal-new-station")}})),L.on("click",(function(t){L.forEachFeatureAtPixel(t.pixel,(function(t,n){for(var a=0;a<e.station.length;a++)if(e.station[a].id==n.get("id")){console.log("layer: "+n.get("id")),e.r_starion=e.station[a],console.log("station: "+JSON.stringify(e.r_starion));for(var i=[],o=0;o<e.products.length;o++)for(var r=e.products[o][0].points,s=0;s<r.length;s++)if(r[s].id==e.r_starion.id){for(var l=[],d=0;d<e.prices.length;d++)e.products[o][0].product_id==e.prices[d][0].product_id&&(l=e.prices[d]);i.push({product_id:e.products[o][0].product_id,status:r[s].status,price:l[0].price,currency:l[0].currency})}console.log("product_: "+JSON.stringify(i)),e.r_product=i;break}console.log("self: "+e),e.$bvModal.show("bv-modal-station")}))}))}},computed:{idState:function(){return null!=this.n_id&&this.n_id.length>2},nameState:function(){return null!=this.n_name&&this.n_name.length>2},adrState:function(){return null!=this.n_address&&this.n_address.length>2},cityState:function(){return null!=this.n_city&&this.n_city.length>2},latitState:function(){return!0},longState:function(){return!0},saveDis:function(){var t=this,e=!1;return e=null!=t.n_id&&t.n_id.length>2,e=null!=t.n_name&&t.n_name.length>2,e=null!=t.n_address&&t.n_address.length>2,e=null!=t.n_city&&t.n_city.length>2,!e}}},D=E,J=Object(O["a"])(D,s,l,!1,null,null,null),$=J.exports,T={name:"app",data:function(){return{}},components:{MapContainer:$}},A=T,H=(n("034f"),Object(O["a"])(A,o,r,!1,null,null,null)),z=H.exports,U=n("c43f"),I=n("1947"),R=n("6aac"),B=n("dbbe"),G=n("00bd"),q={aws_project_region:"eu-west-1"},K=q;a["default"].component("b-form-file",U["a"]),a["default"].component("b-button",I["a"]),a["default"].component("b-modal",R["a"]),G["default"].configure(K),a["default"].use(B["a"]),a["default"].config.productionTip=!1,new a["default"]({render:function(t){return t(z)}}).$mount("#app"),a["default"].use(i["a"])},"85ec":function(t,e,n){}});
//# sourceMappingURL=app.45707588.js.map